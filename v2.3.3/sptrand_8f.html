<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-sp: sptrand.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-sp
   &#160;<span id="projectnumber">2.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('sptrand_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">sptrand.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="sptrand_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae810abad32bcbdfb8345a30e50bcc1ef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sptrand_8f.html#ae810abad32bcbdfb8345a30e50bcc1ef">sptrand</a> (IROMB, MAXWV, IDRT, IMAX, JMAX, KMAX, IPRIME, ISKIP, JNSKIP, JSSKIP, KWSKIP, KGSKIP, JBEG, JEND, JCPU, WAVE, GRIDMN, GRIDXN, GRIDXS, GRIDYN, GRIDYS, IDIR)</td></tr>
<tr class="memdesc:ae810abad32bcbdfb8345a30e50bcc1ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">THIS SUBPROGRAM PERFORMS A SPHERICAL TRANSFORM BETWEEN SPECTRAL COEFFICIENTS OF SCALAR FIELDS AND THEIR MEANS AND GRADIENTS ON A GLOBAL CYLINDRICAL GRID.  <a href="sptrand_8f.html#ae810abad32bcbdfb8345a30e50bcc1ef">More...</a><br /></td></tr>
<tr class="separator:ae810abad32bcbdfb8345a30e50bcc1ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Perform a gradient spherical transform </p><dl class="section author"><dt>Author</dt><dd>IREDELL </dd></dl>
<dl class="section date"><dt>Date</dt><dd>96-02-29 </dd></dl>

<p class="definition">Definition in file <a class="el" href="sptrand_8f_source.html">sptrand.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae810abad32bcbdfb8345a30e50bcc1ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae810abad32bcbdfb8345a30e50bcc1ef">&#9670;&nbsp;</a></span>sptrand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sptrand </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IROMB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>MAXWV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IDRT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>KMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IPRIME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ISKIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JNSKIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JSSKIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>KWSKIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>KGSKIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JBEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JEND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>JCPU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(*)&#160;</td>
          <td class="paramname"><em>WAVE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kmax)&#160;</td>
          <td class="paramname"><em>GRIDMN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(*)&#160;</td>
          <td class="paramname"><em>GRIDXN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(*)&#160;</td>
          <td class="paramname"><em>GRIDXS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(*)&#160;</td>
          <td class="paramname"><em>GRIDYN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(*)&#160;</td>
          <td class="paramname"><em>GRIDYS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>IDIR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>THIS SUBPROGRAM PERFORMS A SPHERICAL TRANSFORM BETWEEN SPECTRAL COEFFICIENTS OF SCALAR FIELDS AND THEIR MEANS AND GRADIENTS ON A GLOBAL CYLINDRICAL GRID. </p>
<p>THE WAVE-SPACE CAN BE EITHER TRIANGULAR OR RHOMBOIDAL. THE GRID-SPACE CAN BE EITHER AN EQUALLY-SPACED GRID (WITH OR WITHOUT POLE POINTS) OR A GAUSSIAN GRID. THE WAVE AND GRID FIELDS MAY HAVE GENERAL INDEXING, BUT EACH WAVE FIELD IS IN SEQUENTIAL 'IBM ORDER', I.E. WITH ZONAL WAVENUMBER AS THE SLOWER INDEX. TRANSFORMS ARE DONE IN LATITUDE PAIRS FOR EFFICIENCY; THUS GRID ARRAYS FOR EACH HEMISPHERE MUST BE PASSED. IF SO REQUESTED, JUST A SUBSET OF THE LATITUDE PAIRS MAY BE TRANSFORMED IN EACH INVOCATION OF THE SUBPROGRAM. THE TRANSFORMS ARE ALL MULTIPROCESSED OVER LATITUDE EXCEPT THE TRANSFORM FROM FOURIER TO SPECTRAL IS MULTIPROCESSED OVER ZONAL WAVENUMBER TO ENSURE REPRODUCIBILITY. TRANSFORM SEVERAL FIELDS AT A TIME TO IMPROVE VECTORIZATION. SUBPROGRAM CAN BE CALLED FROM A MULTIPROCESSING ENVIRONMENT.</p>
<p>PROGRAM HISTORY LOG:</p><ul>
<li>96-02-29 IREDELL</li>
<li>1998-12-15 IREDELL OPENMP DIRECTIVES INSERTED</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">IROMB</td><td>- INTEGER SPECTRAL DOMAIN SHAPE (0 FOR TRIANGULAR, 1 FOR RHOMBOIDAL) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">MAXWV</td><td>- INTEGER SPECTRAL TRUNCATION </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IDRT</td><td>- INTEGER GRID IDENTIFIER (IDRT=4 FOR GAUSSIAN GRID, IDRT=0 FOR EQUALLY-SPACED GRID INCLUDING POLES, IDRT=256 FOR EQUALLY-SPACED GRID EXCLUDING POLES) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IMAX</td><td>- INTEGER EVEN NUMBER OF LONGITUDES. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">JMAX</td><td>- INTEGER NUMBER OF LATITUDES. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KMAX</td><td>- INTEGER NUMBER OF FIELDS TO TRANSFORM. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IPRIME</td><td>- INTEGER LONGITUDE INDEX FOR THE PRIME MERIDIAN. (DEFAULTS TO 1 IF IPRIME=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ISKIP</td><td>- INTEGER SKIP NUMBER BETWEEN LONGITUDES (DEFAULTS TO 1 IF ISKIP=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">JNSKIP</td><td>- INTEGER SKIP NUMBER BETWEEN N.H. LATITUDES FROM NORTH (DEFAULTS TO IMAX IF JNSKIP=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">JSSKIP</td><td>- INTEGER SKIP NUMBER BETWEEN S.H. LATITUDES FROM SOUTH (DEFAULTS TO -IMAX IF JSSKIP=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KWSKIP</td><td>- INTEGER SKIP NUMBER BETWEEN WAVE FIELDS (DEFAULTS TO (MAXWV+1)*((IROMB+1)*MAXWV+2) IF KWSKIP=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KGSKIP</td><td>- INTEGER SKIP NUMBER BETWEEN GRID FIELDS (DEFAULTS TO IMAX*JMAX IF KGSKIP=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">JBEG</td><td>- INTEGER LATITUDE INDEX (FROM POLE) TO BEGIN TRANSFORM (DEFAULTS TO 1 IF JBEG=0) (IF JBEG=0 AND IDIR&lt;0, WAVE IS ZEROED BEFORE TRANSFORM) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">JEND</td><td>- INTEGER LATITUDE INDEX (FROM POLE) TO END TRANSFORM (DEFAULTS TO (JMAX+1)/2 IF JEND=0) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">JCPU</td><td>- INTEGER NUMBER OF CPUS OVER WHICH TO MULTIPROCESS </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">WAVE</td><td>- REAL (*) WAVE FIELDS IF IDIR&gt;0 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GRIDMN</td><td>- REAL (KMAX) GLOBAL MEANS IF IDIR&lt;0 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GRIDXN</td><td>- REAL (*) N.H. X-GRADIENTS (STARTING AT JBEG) IF IDIR&lt;0 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GRIDXS</td><td>- REAL (*) S.H. X-GRADIENTS (STARTING AT JBEG) IF IDIR&lt;0 [GRIDX=(D(WAVE)/DLAM)/(CLAT*RERTH)] <br  />
 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GRIDYN</td><td>- REAL (*) N.H. Y-GRADIENTS (STARTING AT JBEG) IF IDIR&lt;0 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">GRIDYS</td><td>- REAL (*) S.H. Y-GRADIENTS (STARTING AT JBEG) IF IDIR&lt;0 [GRIDY=(D(WAVE)/DPHI)/RERTH] </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">IDIR</td><td>- INTEGER TRANSFORM FLAG (IDIR&gt;0 FOR WAVE TO GRID, IDIR&lt;0 FOR GRID TO WAVE)</td></tr>
  </table>
  </dd>
</dl>
<p>SUBPROGRAMS CALLED:</p><ul>
<li>SPWGET GET WAVE-SPACE CONSTANTS</li>
<li>SPLAPLAC COMPUTE LAPLACIAN IN SPECTRAL SPACE</li>
<li>SPTRANV PERFORM A VECTOR SPHERICAL TRANSFORM</li>
</ul>
<p>REMARKS: MINIMUM GRID DIMENSIONS FOR UNALIASED TRANSFORMS TO SPECTRAL: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DIMENSION </th><th class="markdownTableHeadNone">LINEAR </th><th class="markdownTableHeadNone">QUADRATIC  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IMAX </td><td class="markdownTableBodyNone">2*MAXWV+2 </td><td class="markdownTableBodyNone">3*MAXWV/2*2+2  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">JMAX (IDRT=4,IROMB=0) </td><td class="markdownTableBodyNone">1*MAXWV+1 </td><td class="markdownTableBodyNone">3*MAXWV/2+1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">JMAX (IDRT=4,IROMB=1) </td><td class="markdownTableBodyNone">2*MAXWV+1 </td><td class="markdownTableBodyNone">5*MAXWV/2+1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">JMAX (IDRT=0,IROMB=0) </td><td class="markdownTableBodyNone">2*MAXWV+3 </td><td class="markdownTableBodyNone">3*MAXWV/2*2+3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">JMAX (IDRT=0,IROMB=1) </td><td class="markdownTableBodyNone">4*MAXWV+3 </td><td class="markdownTableBodyNone">5*MAXWV/2*2+3  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">JMAX (IDRT=256,IROMB=0) </td><td class="markdownTableBodyNone">2*MAXWV+1 </td><td class="markdownTableBodyNone">3*MAXWV/2*2+1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">JMAX (IDRT=256,IROMB=1) </td><td class="markdownTableBodyNone">4*MAXWV+1 </td><td class="markdownTableBodyNone">5*MAXWV/2*2+1  </td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="sptrand_8f_source.html#l00087">87</a> of file <a class="el" href="sptrand_8f_source.html">sptrand.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="sptrand_8f.html">sptrand.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
